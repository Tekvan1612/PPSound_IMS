{% include 'product_tracking/head.html' %}
{% load static %}
{% block content %}
    {#    <link rel="stylesheet" href="https://stackpath.bootstrapcdn.com/bootstrap/4.5.2/css/bootstrap.min.css">#}
    <script src="https://ajax.googleapis.com/ajax/libs/jquery/3.5.1/jquery.min.js"></script>
    <script src="https://stackpath.bootstrapcdn.com/bootstrap/4.5.2/js/bootstrap.bundle.min.js"></script>
    <!-- Bootstrap JS -->
    <script src="https://code.jquery.com/jquery-3.5.1.slim.min.js"></script>
    <script src="https://cdn.jsdelivr.net/npm/@popperjs/core@2.5.4/dist/umd/popper.min.js"></script>
    <script src="https://stackpath.bootstrapcdn.com/bootstrap/4.5.2/js/bootstrap.min.js"></script>
    <style>
        .text-danger {
            color: red;
        }

        .table-responsive {
            max-height: 400px;
            overflow-y: auto;
        }

        .modal-body {
            overflow-y: auto;
            max-height: 500px; /* Adjust based on your modal size */
        }

        #equipmentDetailsModal .modal-header {
            background-color: #007bff;
            color: #ffffff;
        }

        #equipmentDetailsModalLabel {

            color: #ffffff;
        }

        .tooltip.bs-tooltip-top .arrow::before,
        .tooltip.bs-tooltip-auto[x-placement^="top"] .arrow::before {
            border-top-color: #5a5a5a;
        }

        .tooltip.bs-tooltip-bottom .arrow::before,
        .tooltip.bs-tooltip-auto[x-placement^="bottom"] .arrow::before {
            border-bottom-color: #5a5a5a;
        }

        .tooltip.bs-tooltip-left .arrow::before,
        .tooltip.bs-tooltip-auto[x-placement^="left"] .arrow::before {
            border-left-color: #5a5a5a;
        }

        .tooltip.bs-tooltip-right .arrow::before,
        .tooltip.bs-tooltip-auto[x-placement^="right"] .arrow::before {
            border-right-color: #5a5a5a;
        }

        .equipment_name a {
            color: #007bff; /* Blue color */
            text-decoration: none; /* Remove default underline */
            cursor: pointer; /* Change cursor to pointer on hover */
        }

        /* Hover effect for equipment_name link */
        .equipment_name a:hover {
            text-decoration: underline; /* Underline on hover */
        }

        #pagination-controls button {
            margin-right: 10px;
        }
    </style>
    <script>
        $(document).ready(function () {
            var fetchingData = false;
            let currentPage = 1;
            const pageSize = 10;
            let totalItems = 0;

            $('#searchSubCategory').on('input', function () {
                var searchText = $(this).val().trim().toLowerCase();

                $('#equipment-table-body tr').each(function () {
                    var subCategoryName = $(this).find('td:eq(2)').text().trim().toLowerCase();
                    var categoryName = $(this).find('td:eq(3)').text().trim().toLowerCase();

                    if (subCategoryName.includes(searchText) || categoryName.includes(searchText)) {
                        $(this).show();
                    } else {
                        $(this).hide();
                    }
                });

                if (searchText === '') {
                    $('#equipment-table-body tr').show();
                }
            });

            $('[data-toggle="tooltip"]').tooltip();
            fetchEquipmentList();

          function fetchEquipmentList() {
        const equipmentListData = document.getElementById('equipment-list-data').textContent;
        let equipmentlist = [];

        try {
            equipmentlist = JSON.parse(equipmentListData);
        } catch (e) {
            console.error("Error parsing JSON data: ", e);
            return;
        }

        const totalItems = equipmentlist.length;
        const totalPages = Math.ceil(totalItems / pageSize);

        const paginatedEquipment = equipmentlist.slice((currentPage - 1) * pageSize, currentPage * pageSize);
        console.log("Equipment Listing:", paginatedEquipment);

        $('#equipment-table-body').empty();
        $.each(paginatedEquipment, function (index, equipment) {
            const row = `<tr>
                <td>${((currentPage - 1) * pageSize + index + 1)}</td>
                <td style="display: none;">${equipment.id}</td>
                <td class="equipment_name" data-id="${equipment.id}">
                    <a href="#" class="equipment-link">${equipment.equipment_name}</a>
                </td>
                <td>${equipment.type}</td>
                <td>${equipment.sub_category_name}</td>
                <td>${equipment.category_type}</td>
                <td><img src="${equipment.attachment}" alt="Equipment Image" width="70" height="60"></td>
                <td>${equipment.created_by.toUpperCase()}</td>
                <td>${equipment.created_date}</td>
                <td>
                    <button class="btn btn-sm btn-primary edit-btn me-2" data-toggle="tooltip" title="Edit Equipment"><i class="fa fa-pencil"></i></button>
                    <button class="btn btn-sm btn-danger delete-btn me-2" data-toggle="tooltip" title="Delete Equipment"><i class="fa fa-trash"></i></button>
                    <button class="btn btn-sm btn-primary vendor-btn btn-group" data-toggle="tooltip" title="Add Stock and Serial number"><i class="fa fa-add"></i></button>
                </td>
            </tr>`;
            $('#equipment-table-body').append(row);
        });

        updatePaginationControls(totalItems, currentPage, totalPages);
    }


            function updatePaginationControls(totalItems, currentPage, totalPages) {
                $('#pagination-controls').html('');

                if (currentPage > 1) {
                    $('#pagination-controls').append('<button id="prev-page-btn" class="btn btn-primary">Previous</button>');
                }

                if (currentPage < totalPages) {
                    $('#pagination-controls').append('<button id="next-page-btn" class="btn btn-primary">Next</button>');
                }

                const startItem = (currentPage - 1) * pageSize + 1;
                const endItem = Math.min(currentPage * pageSize, totalItems);

                $('#pagination-count').text(`Showing ${startItem} to ${endItem} of ${totalItems} entries`);
            }

            $(document).on('click', '#prev-page-btn', function () {
                if (currentPage > 1) {
                    currentPage--;
                    fetchEquipmentList();
                }
            });

            $(document).on('click', '#next-page-btn', function () {
                currentPage++;
                fetchEquipmentList();
            });
            $(document).on('click', '.edit-btn', function () {
                var row = $(this).closest('tr');
                var employeeId = row.find('td:eq(1)').text().trim();
                var employeeName = row.find('td:eq(2)').text().trim();
                var subCategory = row.find('td:eq(4)').text().trim();
                var categoryType = row.find('td:eq(5)').text().trim();
                var equipmentType = row.find('td:eq(3)').text().trim();

                $('#editCategoryId').val(employeeId);
                $('#editCategoryName').val(employeeName);
                $('#editSubCategoryName').val(subCategory);
                $('#editCategoryType').val(categoryType);
                $('#editEquipmentType').val(equipmentType);

                $('#editCategoryModal').modal('show');

                $('#editSubCategoryName').off('change');

                $('#editSubCategoryName').on('change', function () {
                    var selectedSubcategory = $(this).val();
                    $.ajax({
                        url: '/edit_get_category_name/',
                        type: 'GET',
                        dataType: 'json',
                        data: {subcategory_id: selectedSubcategory},
                        success: function (response) {
                            $('#editCategoryType').val(response.category_name);
                        },
                        error: function (xhr, status, error) {
                            console.error('Error fetching category name:', error);
                        }
                    });

                    // Fetch and populate the types dropdown
                    $.ajax({
                        url: '/edit_subcategory_dropdown/',
                        type: 'GET',
                        dataType: 'json',
                        data: {subcategory_id: selectedSubcategory},
                        success: function (response) {
                            var selectedSubcategoryData = response.sub.find(sub => sub.id == selectedSubcategory);
                            if (selectedSubcategoryData) {
                                var types = selectedSubcategoryData.type.split(',');
                                var $select = $('#editEquipmentType');
                                $select.empty();
                                types.forEach(function (type) {
                                    $select.append('<option value="' + type + '">' + type + '</option>');
                                });
                            }
                        },
                        error: function (xhr, status, error) {
                            console.error('Error fetching subcategories:', error);
                        }
                    });
                });

                $.ajax({
                    url: '/edit_subcategory_dropdown/',
                    type: 'GET',
                    dataType: 'json',
                    success: function (data) {
                        var dropdown = $('#editSubCategoryName');
                        dropdown.empty();
                        dropdown.append($('<option></option>').attr('value', subCategory).text(subCategory));
                        $.each(data.sub, function (index, subcategory) {
                            if (subcategory.name !== subCategory) {
                                dropdown.append($('<option></option>').attr('value', subcategory.id).text(subcategory.name));
                            }
                        });
                    },
                    error: function (xhr, status, error) {
                        console.error('Error fetching subcategories:', error);
                    }
                });
            });


            $(document).on('click', '#saveChangesBtn', function () {
                updateCategoryInDatabase();
            });

            function updateCategoryInDatabase() {
                var employeeId = $('#editCategoryId').val();
                var employeeName = $('#editCategoryName').val().trim();
                var subCategory = $('#editSubCategoryName').val().trim();
                var categoryType = $('#editCategoryType').val().trim();
                var equipmentType = $('#editEquipmentType').val().trim();

                if (!employeeId || !employeeName || !subCategory || !categoryType || !equipmentType) {
                    console.error("One or more fields are null or empty");
                    alert("Please fill in all the required fields.");
                    return;
                }

                var formData = new FormData();
                formData.append('csrfmiddlewaretoken', getCookie('csrftoken'));
                formData.append('employeeId', employeeId);
                formData.append('employeeName', employeeName);
                formData.append('subCategory', subCategory);
                formData.append('categoryType', categoryType);
                formData.append('equipmentType', equipmentType);

                $.ajax({
                    url: '/update_equipment/' + employeeId + '/',
                    type: 'POST',
                    data: formData,
                    processData: false,
                    contentType: false,
                    success: function (response) {
                        fetchEquipmentList();
                        $('#editCategoryModal').modal('hide');
                        location.reload();
                    },
                    error: function (xhr, status, error) {
                        console.error('Error updating category:', error);
                    }
                });
            }

            $(document).on('click', '.delete-btn', function () {
                var row = $(this).closest('tr');
                var equipmentId = row.find('td:eq(1)').text().trim();

                if (confirm('Are you sure you want to delete this Equipment?')) {
                    var csrftoken = getCookie('csrftoken');

                    $.ajax({
                        url: '/delete_equipment_list/' + equipmentId + '/',
                        type: 'POST',
                        beforeSend: function (xhr) {
                            xhr.setRequestHeader('X-CSRFToken', csrftoken);
                        },
                        success: function (response) {
                            location.reload();
                        },
                        error: function (xhr, status, error) {
                            console.error('Error deleting Equipment:', error);
                        }
                    });
                }
            });

            function getCookie(name) {
                var cookieValue = null;
                if (document.cookie && document.cookie !== '') {
                    var cookies = document.cookie.split(';');
                    for (var i = 0; i < cookies.length; i++) {
                        var cookie = cookies[i].trim();
                        if (cookie.substring(0, name.length + 1) === (name + '=')) {
                            cookieValue = decodeURIComponent(cookie.substring(name.length + 1));
                            break;
                        }
                    }
                }
                return cookieValue;
            }

            $(document).on('click', '#closeFormBtn', function () {
                $('#editCategoryModal').modal('hide');
            });

            $(document).on('click', '#closeFormBtn', function () {
                $('#editVendorModal').modal('hide');
            });

            $(document).on('click', '.close', function () {
                $('#stockModal').modal('hide');
            });

            $(document).on('click', '.vendor-btn', function () {
                var row = $(this).closest('tr');
                var equipmentId = row.find('td:eq(1)').text().trim();

                $('#editVendorId').val(equipmentId);
                $('#equipmentIdInput').val(equipmentId);
                $('#editVendorModal').modal('show');
                $.ajax({
                    url: '/stock-in/' + equipmentId + '/',
                    type: 'GET',
                    success: function (data) {
                        var stockDetailsContainer = $('#stockDetailsContainer');
                        stockDetailsContainer.empty();

                        if (data.error) {
                            stockDetailsContainer.html('<p>' + data.error + '</p>');
                        } else {
                            var tableHtml = '<div class="table-responsive" style="max-height: 400px; overflow-y: auto;">';
                            tableHtml += '<table class="table primary-table-bordered">';
                            tableHtml += '<thead class="thead-primary"><tr>' +
                                '<th>Vendor Name</th>' +
                                '<th>Serial Number</th>' +
                                '<th>Barcode Number</th>' +
                                '<th>Unit Price</th>' +
                                '<th>Rental Price</th>' +
                                '<th>Purchase Date</th>' +
                                '<th>Reference Number</th>' +
                                '<th>Action</th>' +
                                '</tr></thead><tbody>';

                            data.forEach(function (item, index) {
                                tableHtml += '<tr>' +
                                    '<td style="display: none;">' + item.id + '</td>' +
                                    '<td class="editable" data-field="vendor_name">' + item.vendor_name + '</td>' +
                                    '<td class="editable" data-field="serial_number">' + item.serial_number + '</td>' +
                                    '<td class="editable" data-field="barcode_number">' + item.barcode_number + '</td>' +
                                    '<td class="editable" data-field="unit_price">' + item.unit_price + '</td>' +
                                    '<td class="editable" data-field="rental_price">' + item.rental_price + '</td>' +
                                    '<td class="editable" data-field="purchase_date">' + item.purchase_date + '</td>' +
                                    '<td class="editable" data-field="reference_no">' + item.reference_no + '</td>' +
                                    '<td>' +
                                    '<button class="btn btn-primary edit-button" type="button"><i class="fa fa-pencil"></i></button>' +
                                    '<button class="btn btn-success save-button" type="button" style="display:none;"><i class="fa fa-check"></i></button>' +
                                    '</td>' +
                                    '</tr>';
                            });

                            tableHtml += '</tbody></table>';
                            tableHtml += '</div>';

                            stockDetailsContainer.html(tableHtml);

                            $('.edit-button').click(function () {
                                var row = $(this).closest('tr');
                                row.find('.editable').each(function () {
                                    var cell = $(this);
                                    var field = cell.data('field');
                                    var value = cell.text();
                                    cell.html('<input type="text" class="form-control" name="' + field + '" value="' + value + '">');
                                });
                                $(this).hide();
                                row.find('.save-button').show();
                            });

                            $('.save-button').click(function () {
                                var row = $(this).closest('tr');
                                var rowId = row.find('td:first').text();
                                var updatedData = {};

                                row.find('input').each(function () {
                                    var input = $(this);
                                    updatedData[input.attr('name')] = input.val();
                                });

                                $.ajax({
                                    url: '/update-stock-in/' + rowId + '/',
                                    type: 'POST',
                                    headers: {'X-CSRFToken': getCookie('csrftoken')},
                                    data: updatedData,
                                    success: function (response) {
                                        if (response.success) {
                                            row.find('.editable').each(function () {
                                                var cell = $(this);
                                                var field = cell.data('field');
                                                cell.html(updatedData[field]);
                                            });
                                            row.find('.save-button').hide();
                                            row.find('.edit-button').show();
                                        } else {
                                            console.error('Update failed:', response.error);
                                        }
                                    },
                                    error: function (xhr, status, error) {
                                        console.error('Error updating row:', error);
                                    }
                                });
                            });
                        }

                        $('#stockDetailsModal').modal('show');
                    },
                    error: function (xhr, status, error) {
                        $('#stockDetailsContainer').html('<p>An error occurred: ' + error + '</p>');
                        $('#stockDetailsModal').modal('show');
                    }
                });
            });

            $('#editUnit').on('input', function () {
                var num = parseInt(this.value);
                generateInputColumns(num);
            });

            function generateInputColumns(num) {
                var container = document.getElementById('serialNumberInputsContainer');
                container.innerHTML = '';

                for (var i = 0; i < num; i++) {
                    var inputDiv = document.createElement('div');
                    inputDiv.className = 'row';

                    var serialNumberDiv = document.createElement('div');
                    serialNumberDiv.className = 'col-xl-6 mb-3';

                    var labelSerial = document.createElement('label');
                    labelSerial.htmlFor = 'serialNumber' + (i + 1);
                    labelSerial.className = 'form-label';
                    labelSerial.textContent = 'Serial Number ' + (i + 1);

                    var inputSerial = document.createElement('input');
                    inputSerial.type = 'text';
                    inputSerial.className = 'form-control';
                    inputSerial.id = 'serialNumber' + (i + 1);
                    inputSerial.name = 'serialNumber' + (i + 1);

                    serialNumberDiv.appendChild(labelSerial);
                    serialNumberDiv.appendChild(inputSerial);
                    inputDiv.appendChild(serialNumberDiv);

                    var barcodeDiv = document.createElement('div');
                    barcodeDiv.className = 'col-xl-6 mb-3';

                    var labelBarcode = document.createElement('label');
                    labelBarcode.htmlFor = 'barcode' + (i + 1);
                    labelBarcode.className = 'form-label';
                    labelBarcode.textContent = 'Barcode Number ' + (i + 1);

                    var inputBarcode = document.createElement('input');
                    inputBarcode.type = 'text';
                    inputBarcode.className = 'form-control';
                    inputBarcode.id = 'barcodeNumber' + (i + 1);
                    inputBarcode.name = 'barcodeNumber' + (i + 1);

                    barcodeDiv.appendChild(labelBarcode);
                    barcodeDiv.appendChild(inputBarcode);
                    inputDiv.appendChild(barcodeDiv);

                    container.appendChild(inputDiv);
                }
            }

            function populateSubcategoryInput(selectedSubcategoryId) {
                $.ajax({
                    url: '/fetch_subcategory_name/' + selectedSubcategoryId + '/',
                    type: 'GET',
                    dataType: 'json',
                    success: function (data) {
                        if (data.subcategory_name) {
                            $('#exampleFormControlInput3').val(data.subcategory_name);
                            $('#exampleFormControlInput3').attr('data-subcategory-id', data.subcategory_id);
                            $('#hiddenSubcategoryId').val(data.subcategory_id);
                            populateCategoryType(selectedSubcategoryId);
                            populateSubcategoryType(selectedSubcategoryId);
                        } else if (data.error) {
                            alert(data.error);
                        }
                    },
                    error: function (xhr, status, error) {
                        console.error('Error fetching subcategory name:', error);
                    }
                });
            }


            $(document).ready(function () {
                var urlParams = new URLSearchParams(window.location.search);
                var subcategoryId = urlParams.get('subcategory_id');

                if (subcategoryId) {
                    populateSubcategoryInput(subcategoryId);
                }
            });

            function populateCategoryType(subcategoryId) {
                $.ajax({
                    url: '/get_category_type/',
                    type: 'GET',
                    data: {subcategory_id: subcategoryId},
                    dataType: 'json',
                    success: function (data) {
                        if (data.category_name) {
                            $('#exampleFormControlInput4').val(data.category_name);
                        } else if (data.error) {
                            alert(data.error);
                        }
                    },
                    error: function (xhr, status, error) {
                        console.error('Error fetching category type:', error);
                    }
                });
            }

            function populateSubcategoryType(subcategoryId) {
                $.ajax({
                    url: '/fetch_subcategory_type/' + subcategoryId + '/',
                    type: 'GET',
                    dataType: 'json',
                    success: function (data) {
                        if (typeof data.subcategory_type === 'string') {
                            var types = data.subcategory_type.split(',').map(function (type) {
                                return type.trim();
                            });

                            var $select = $('#exampleFormControlInput5');
                            $select.empty();

                            types.forEach(function (type) {
                                if (type) {
                                    $select.append('<option value="' + type + '">' + type + '</option>');
                                }
                            });
                        } else {
                            alert('Invalid data format received.');
                        }
                    },
                    error: function (xhr, status, error) {
                        console.error('Error fetching subcategory type:', error);
                    }
                });
            }

            function populateSubcategoryTypeEdit(subcategoryId) {
                $.ajax({
                    url: '/fetch_subcategory_type/' + subcategoryId + '/',
                    type: 'GET',
                    dataType: 'json',
                    success: function (data) {
                        if (typeof data.subcategory_type === 'string') {
                            var types = data.subcategory_type.split(',').map(function (type) {
                                return type.trim();
                            });

                            var $select = $('#editEquipmentType');
                            $select.empty();

                            types.forEach(function (type) {
                                if (type) {
                                    $select.append('<option value="' + type + '">' + type + '</option>');
                                }
                            });
                        } else {
                            console.error('Expected a string for subcategory_type, but got:', typeof data.subcategory_type);
                            alert('Invalid data format received.');
                        }
                    },
                    error: function (xhr, status, error) {
                        console.error('Error fetching subcategory type:', error);
                    }
                });
            }

            var urlParams = new URLSearchParams(window.location.search);
            var subcategoryId = urlParams.get('subcategory_id');

            if (subcategoryId) {
                populateCategoryType(subcategoryId);
            }

            $('#exampleFormControlInput3').on('change', function () {
                var selectedSubcategory = $(this).val();
                if (selectedSubcategory) {
                    populateCategoryType(selectedSubcategory);
                    populateSubcategoryType(selectedSubcategory);
                } else {
                    $('#exampleFormControlInput4').val('');
                    $('#exampleFormControlInput5').empty();
                }
            });

            $('.dimension').on('input', function () {
                calculateVolume();
            });

            function calculateVolume() {
                var dimension_h = parseFloat($('#dimension_h').val());
                var dimension_w = parseFloat($('#dimension_w').val());
                var dimension_l = parseFloat($('#dimension_l').val());
                var volumeField = $('#volume');

                if (!isNaN(dimension_h) && !isNaN(dimension_w) && !isNaN(dimension_l)) {
                    var volume = dimension_h * dimension_w * dimension_l;
                    volumeField.val(volume);
                } else {
                    volumeField.val('');
                }
            }

            function populateOnLoad() {
                var urlParams = new URLSearchParams(window.location.search);
                var subcategoryId = urlParams.get('subcategory_id');

                if (subcategoryId) {
                    populateCategoryType(subcategoryId);
                    populateSubcategoryType(subcategoryId);
                }
            }

            populateOnLoad();

            $('#addEquipmentForm').on('submit', function (event) {
                event.preventDefault();

                var formData = new FormData(this);

                // Check if Category type is filled
                var categoryType = $('#exampleFormControlInput4').val().trim();
                if (!categoryType) {
                    alert('Category type is required');
                    return;
                }

                $.ajax({
                    url: $(this).attr('action'),
                    type: 'POST',
                    data: formData,
                    processData: false,
                    contentType: false,
                    success: function (response) {
                        if (response.success) {
                            alert(response.message || 'Equipment added successfully!');
                            location.reload();
                        } else {
                            alert(response.message || 'An error occurred while adding equipment.');
                        }
                    },
                    error: function (response) {
                        var errorMessage = 'An unexpected error occurred. Please try again.';
                        if (response.responseJSON && response.responseJSON.message) {
                            errorMessage = response.responseJSON.message;
                        }
                        alert(errorMessage);
                    }
                });
            });

            $(document).on('click', '.equipment_name a', function (e) {
                e.preventDefault();

                var equipmentId = $(this).closest('.equipment_name').data('id');
                var modalSelector = '#equipmentDetailsModal';

                $(modalSelector).find('.modal-body').html('');

                $.ajax({
                    url: '/get_dimension_list/' + equipmentId + '/',
                    type: 'GET',
                    success: function (response) {
                        if (response.error) {
                            console.error('Error:', response.error);
                            return;
                        }

                        var popupContent = '<div class="container">';

                        popupContent += '<div class="row">';
                        popupContent += '<div class="col-md-12">';
                        popupContent += '<h6>Dimensions & Other Details</h6>';
                        popupContent += '<div class="table-responsive" style="max-height: 200px; overflow-y: auto;">';
                        popupContent += '<table class="table table-bordered">';
                        popupContent += '<thead>';
                        popupContent += '<tr>';
                        popupContent += '<th>Height</th>';
                        popupContent += '<th>Width</th>';
                        popupContent += '<th>Length</th>';
                        popupContent += '<th>Volume</th>';
                        popupContent += '<th>Weight</th>';
                        popupContent += '<th>HSN No</th>';
                        popupContent += '<th>Country Of Origin</th>';
                        popupContent += '<th>Status</th>';
                        popupContent += '<th>Created By</th>';
                        popupContent += '<th>Created Date</th>';
                        popupContent += '</tr>';
                        popupContent += '</thead>';
                        popupContent += '<tbody>';
                        popupContent += '<tr>';
                        popupContent += '<td>' + response.dimension_height + '</td>';
                        popupContent += '<td>' + response.dimension_width + '</td>';
                        popupContent += '<td>' + response.dimension_length + '</td>';
                        popupContent += '<td>' + response.volume + '</td>';
                        popupContent += '<td>' + response.weight + '</td>';
                        popupContent += '<td>' + response.hsn_no + '</td>';
                        popupContent += '<td>' + response.country_origin + '</td>';
                        popupContent += '<td>' + (response.status ? 'Active' : 'Inactive') + '</td>';
                        popupContent += '<td>' + response.created_by + '</td>';
                        popupContent += '<td>' + response.created_date + '</td>';
                        popupContent += '</tr>';
                        popupContent += '</tbody>';
                        popupContent += '</table>';
                        popupContent += '</div>';
                        popupContent += '</div>';
                        popupContent += '</div>';

                        popupContent += '<div class="row mt-4">';
                        popupContent += '<div class="col-md-12">';
                        popupContent += '<h6>Stock Details</h6>';
                        popupContent += '<div class="table-responsive">';
                        popupContent += '<table class="table table-bordered">';
                        popupContent += '<thead>';
                        popupContent += '<tr>';
                        popupContent += '<th>Vendor Name</th>';
                        popupContent += '<th>Serial Number</th>';
                        popupContent += '<th>Barcode Number</th>';
                        popupContent += '<th>Unit Price</th>';
                        popupContent += '<th>Rental Price</th>';
                        popupContent += '<th>Purchase Date</th>';
                        popupContent += '<th>Reference Number</th>';
                        popupContent += '</tr>';
                        popupContent += '</thead>';
                        popupContent += '<tbody>';

                        if (response.serial_no && response.barcode_no && response.serial_no.length > 0) {
                            for (var i = 0; i < response.serial_no.length; i++) {
                                popupContent += '<tr>';
                                popupContent += '<td>' + (response.vendor_name ? response.vendor_name : '-') + '</td>';
                                popupContent += '<td>' + (response.serial_no[i] ? response.serial_no[i] : '-') + '</td>';
                                popupContent += '<td>' + (response.barcode_no[i] ? response.barcode_no[i] : '-') + '</td>';
                                popupContent += '<td>' + (response.unit_price ? response.unit_price : '-') + '</td>';
                                popupContent += '<td>' + (response.rental_price ? response.rental_price : '-') + '</td>';
                                popupContent += '<td>' + (response.purchase_date ? response.purchase_date : '-') + '</td>';
                                popupContent += '<td>' + (response.reference_no ? response.reference_no : '-') + '</td>';
                                popupContent += '</tr>';
                            }
                        } else {
                            popupContent += '<tr>';
                            popupContent += '<td colspan="7">No data available</td>';
                            popupContent += '</tr>';
                        }
                        popupContent += '</tbody>';
                        popupContent += '</table>';
                        popupContent += '</div>';
                        popupContent += '</div>';
                        popupContent += '</div>';

                        popupContent += '</div>';

                        $(modalSelector).find('.modal-body').html(popupContent);

                        $(modalSelector).modal('show');
                    },
                    error: function (xhr, status, error) {
                        console.error('Error:', error);
                    }
                });
            });

            $(document).on('click', '.vendor-btn', function () {
                var row = $(this).closest('tr');
                var equipmentId = row.find('td:eq(1)').text().trim();

                $('#editVendorId').val(equipmentId);
                $('#equipmentIdInput').val(equipmentId);
                $('#editVendorModal').modal('show');
                $.ajax({
                    url: '/stock-in/' + equipmentId + '/',
                    type: 'GET',
                    success: function (data) {
                        console.log('Fetched Data:', data);

                        var stockDetailsContainer = $('#stockDetailsContainer');
                        stockDetailsContainer.empty();

                        if (data.error) {
                            stockDetailsContainer.html('<p>' + data.error + '</p>');
                        } else {
                            var tableHtml = '<div class="table-responsive" style="max-height: 400px; overflow-y: auto;">';
                            tableHtml += '<table class="table primary-table-bordered">';
                            tableHtml += '<thead class="thead-primary"><tr>' +
                                '<th>Vendor Name</th>' +
                                '<th>Serial Number</th>' +
                                '<th>Barcode Number</th>' +
                                '<th>Unit Price</th>' +
                                '<th>Rental Price</th>' +
                                '<th>Purchase Date</th>' +
                                '<th>Reference Number</th>' +
                                '<th>Action</th>' +
                                '</tr></thead><tbody>';

                            data.forEach(function (item, index) {
                                console.log('Item:', item);
                                tableHtml += '<tr>' +
                                    '<td style="display: none;">' + item.id + '</td>' +
                                    '<td class="editable" data-field="vendor_name">' + item.vendor_name + '</td>' +
                                    '<td class="editable" data-field="serial_number">' + item.serial_number + '</td>' +
                                    '<td class="editable" data-field="barcode_number">' + item.barcode_number + '</td>' +
                                    '<td class="editable" data-field="unit_price">' + item.unit_price + '</td>' +
                                    '<td class="editable" data-field="rental_price">' + item.rental_price + '</td>' +
                                    '<td class="editable" data-field="purchase_date">' + item.purchase_date + '</td>' +
                                    '<td class="editable" data-field="reference_no">' + item.reference_no + '</td>' +
                                    '<td>' +
                                    '<button class="btn btn-primary edit-button" type="button"><i class="fa fa-pencil"></i></button>' +
                                    '<button class="btn btn-success save-button" type="button" style="display:none;"><i class="fa fa-check"></i></button>' +
                                    '</td>' +
                                    '</tr>';
                            });

                            tableHtml += '</tbody></table>';
                            tableHtml += '</div>';

                            stockDetailsContainer.html(tableHtml);

                            $('.edit-button').click(function () {
                                var row = $(this).closest('tr');
                                row.find('.editable').each(function () {
                                    var cell = $(this);
                                    var field = cell.data('field');
                                    var value = cell.text();
                                    cell.html('<input type="text" class="form-control" name="' + field + '" value="' + value + '">');
                                });
                                $(this).hide();
                                row.find('.save-button').show();
                            });

                            $('.save-button').click(function () {
                                var row = $(this).closest('tr');
                                var rowId = row.find('td:first').text();
                                var updatedData = {};

                                row.find('input').each(function () {
                                    var input = $(this);
                                    updatedData[input.attr('name')] = input.val();
                                });

                                $.ajax({
                                    url: '/update-stock-in/' + rowId + '/',
                                    type: 'POST',
                                    headers: {'X-CSRFToken': '{{ csrf_token }}'},
                                    data: updatedData,
                                    success: function (response) {
                                        if (response.success) {
                                            row.find('.editable').each(function () {
                                                var cell = $(this);
                                                var field = cell.data('field');
                                                cell.html(updatedData[field]);
                                            });
                                            row.find('.save-button').hide();
                                            row.find('.edit-button').show();
                                        } else {
                                            console.error('Update failed:', response.error);
                                        }
                                    },
                                    error: function (xhr, status, error) {
                                        console.error('Error updating row:', error);
                                    }
                                });
                            });
                        }

                        $('#stockDetailsModal').modal('show');
                    },
                    error: function (xhr, status, error) {
                        $('#stockDetailsContainer').html('<p>An error occurred: ' + error + '</p>');
                        $('#stockDetailsModal').modal('show');
                    }
                });

                function generateInputColumns(num) {
                    var container = document.getElementById('serialNumberInputsContainer');
                    container.innerHTML = '';

                    for (var i = 0; i < num; i++) {
                        var inputDiv = document.createElement('div');
                        inputDiv.className = 'row';

                        var serialNumberDiv = document.createElement('div');
                        serialNumberDiv.className = 'col-xl-6 mb-3';

                        var labelSerial = document.createElement('label');
                        labelSerial.htmlFor = 'serialNumber' + (i + 1);
                        labelSerial.className = 'form-label';
                        labelSerial.textContent = 'Serial Number ' + (i + 1);

                        var inputSerial = document.createElement('input');
                        inputSerial.type = 'text';
                        inputSerial.className = 'form-control';
                        inputSerial.id = 'serialNumber' + (i + 1);
                        inputSerial.name = 'serialNumber' + (i + 1);

                        serialNumberDiv.appendChild(labelSerial);
                        serialNumberDiv.appendChild(inputSerial);
                        inputDiv.appendChild(serialNumberDiv);

                        var barcodeDiv = document.createElement('div');
                        barcodeDiv.className = 'col-xl-6 mb-3';

                        var labelBarcode = document.createElement('label');
                        labelBarcode.htmlFor = 'barcode' + (i + 1);
                        labelBarcode.className = 'form-label';
                        labelBarcode.textContent = 'Barcode Number ' + (i + 1);

                        var inputBarcode = document.createElement('input');
                        inputBarcode.type = 'text';
                        inputBarcode.className = 'form-control';
                        inputBarcode.id = 'barcodeNumber' + (i + 1);
                        inputBarcode.name = 'barcodeNumber' + (i + 1);

                        barcodeDiv.appendChild(labelBarcode);
                        barcodeDiv.appendChild(inputBarcode);
                        inputDiv.appendChild(barcodeDiv);

                        container.appendChild(inputDiv);
                    }
                }

                document.getElementById('editUnit').addEventListener('input', function () {
                    var num = parseInt(this.value);
                    generateInputColumns(num);
                });
            });

            $(document).on('click', '#saveChanges', function () {
                var formData = new FormData($('#vendorForm')[0]);

                $.ajax({
                    url: '/insert_vendor/',
                    method: 'POST',
                    data: formData,
                    contentType: false,
                    processData: false,
                    success: function (response) {
                        console.log("Data inserted into database successfully");
                        alert("Vendor data saved successfully!");
                    },
                    error: function (xhr, status, error) {
                        console.error("Error inserting data into database:", error);
                    }
                });
            });

            $('#backButton').click(function () {
                var category_id = '{{ category_id }}';
                console.log("categoryId:",category_id)
                window.location.href = '/sub_category/' + category_id + '/';
            });
            $(document).on('click', '#saveChanges', function () {
                var formData = new FormData($('#vendorForm')[0]);

                $.ajax({
                    url: '/insert_vendor/', // Make sure the URL matches your viewâ€™s URL pattern
                    method: 'POST',
                    data: formData,
                    contentType: false,
                    processData: false,
                    success: function (response) {
                        console.log("Data inserted into database successfully");
                        // Optionally, handle successful response
                    },
                    error: function (xhr, status, error) {
                        console.error("Error inserting data into database:", error);
                        // Optionally, handle error response
                    }
                });
            });
        });
    </script>

    <body>

    <!--*******************
        Preloader start
    ********************-->
    <div id="preloader">
        <div class="lds-ripple">
            <div></div>
            <div></div>
        </div>
    </div>
    <!--*******************
        Preloader end
    ********************-->

    <!--**********************************
        Main wrapper start
    ***********************************-->
    <div id="main-wrapper">
        <!--**********************************
            Nav header start
        ***********************************-->
        {% include 'product_tracking/navheader.html' %}
        <!--**********************************
            Nav header end
        ***********************************-->

        <!--**********************************
            Chat box start
        ***********************************-->

        <!--**********************************
            Chat box End
        ***********************************-->

        <!--**********************************
            Header start
        ***********************************-->
        {% include 'product_tracking/header.html' %}
        <!--**********************************
            Header end ti-comment-alt
        ***********************************-->

        <!--**********************************
            Sidebar start
        ***********************************-->
        {% include 'product_tracking/sidebar.html' %}

        <!--**********************************
            Sidebar end
        ***********************************-->

        <!--**********************************
            Content body start
        ***********************************-->
        <div class="content-body">
            <!-- row -->
            <div class="page-titles">
                <ol class="breadcrumb">
                    <li><h5 class="bc-title" style="color: #0c0c0c;">Equipment List</h5></li>
                    <li class="breadcrumb-item"><a href="javascript:void(0)">
                        <svg width="17" height="17" viewBox="0 0 17 17" fill="none" xmlns="http://www.w3.org/2000/svg">
                            <path d="M2.125 6.375L8.5 1.41667L14.875 6.375V14.1667C14.875 14.5424 14.7257 14.9027 14.4601 15.1684C14.1944 15.4341 13.8341 15.5833 13.4583 15.5833H3.54167C3.16594 15.5833 2.80561 15.4341 2.53993 15.1684C2.27426 14.9027 2.125 14.5424 2.125 14.1667V6.375Z"
                                  stroke="#2C2C2C" stroke-linecap="round" stroke-linejoin="round"/>
                            <path d="M6.375 15.5833V8.5H10.625V15.5833" stroke="#2C2C2C" stroke-linecap="round"
                                  stroke-linejoin="round"/>
                        </svg>
                        Home </a>
                    </li>
                </ol>
                <div>
                    <a class="btn btn-primary btn-sm" data-bs-toggle="offcanvas" href="#offcanvasExample" role="button"
                       aria-controls="offcanvasExample">+ Add Equipment</a>
                </div>
            </div>

            <div class="container-fluid">
                <div class="row">
                    <div class="col-xl-12">
                        <div class="card">
                            <div class="card-header d-flex justify-content-between align-items-center">
                                <h4 class="card-title mb-0">Equipment List </h4>
                                <div class="d-flex">
                                    <input type="text" class="form-control me-2" id="searchSubCategory"
                                           placeholder="Search....">
                                    <button class="btn btn-secondary" id="backButton">Back</button>
                                    <input type="hidden" id="categoryId" value="{{ category_id }}">
                                </div>
                            </div>
                            <div class="card-body">
                                <div class="table-responsive table-card">
                                    <table class="table primary-table-bordered">
                                        <thead class="thead-primary">
                                        <tr>
                                            <th>SR NO</th>
                                            <th>Equipment Name</th>
                                            <th>Equipment Type</th>
                                            <th>Sub Category</th>
                                            <th>Category</th>
                                            <th>Image</th>
                                            <th>Added By</th>
                                            <th>Added Date</th>
                                            <th>Action</th>
                                        </tr>
                                        </thead>
                                        <tbody id="equipment-table-body">
                                        </tbody>
                                    </table>
                                </div>
                            </div>
                            <div class="d-flex justify-content-between align-items-center mt-3">
                                <div id="pagination-count" style="padding: 10px;">Showing 0 to 0 of 0 entries</div>
                                <div id="pagination-controls" style="padding-bottom: 10px;margin: 5px;">
                                    <!-- Pagination buttons will be appended here -->
                                </div>
                            </div>
                        </div>
                    </div>
                </div>
            </div>


        </div>

        <!--**********************************
            Content body end
        ***********************************-->


        <!--**********************************
            Footer start
        ***********************************-->
        {% include 'product_tracking/footer.html' %}
        <!--**********************************
            Footer end
        ***********************************-->
        <!-- Edit Equipment Details -->
        <div class="modal fade" id="editCategoryModal" tabindex="-1" role="dialog"
             aria-labelledby="editCategoryModalLabel" aria-hidden="true">
            <div class="modal-dialog modal-lg" role="document">
                <div class="modal-content">
                    <div class="modal-header">
                        <h5 class="modal-title" id="editCategoryModalLabel">Edit Employee</h5>

                    </div>
                    <div class="modal-body">
                        <!-- Category Model Form -->
                        <form id="editCategoryForm">

                            <div class="row">
                                <div class="col-xl-3 mb-3">
                                    <label for="editCategoryName">Equipment Name</label>
                                    <input type="text" class="form-control" id="editCategoryName" name="employeeName">
                                </div>
                                <div class="col-xl-3 mb-3">
                                    <label for="editSubCategoryName" class="form-label">Sub Category Name</label>
                                    <select class="form-control" id="editSubCategoryName" name="subCategory">
                                        {% for subcategories in sub %}
                                            <option value="{{ subcategories.name }}">{{ subcategories.name }}</option>
                                        {% endfor %}
                                    </select>
                                </div>
                                <div class="col-xl-3 mb-3">
                                    <label for="editCategoryType" class="form-label">Category Name</label>
                                    <input type="text" class="form-control" id="editCategoryType" name="categoryType">
                                </div>
                                {#                                <div class="col-xl-3 mb-3">#}
                                {#                                    <label for="editEquipmentType" class="form-label">Equipment Type<span#}
                                {#                                            class="text-danger">*</span></label>#}
                                {#                                    <select class="default-select form-control" id="editEquipmentType"#}
                                {#                                            name="equipmentType">#}
                                {#                                        <option value="Moniter">Moniter</option>#}
                                {#                                        <option value="Slit Speaker">Slit Speaker</option>#}
                                {#                                        <option value="SubWoofer">SubWoofer</option>#}
                                {#                                        <option value="Top">Top</option>#}
                                {#                                    </select>#}
                                {#                                </div>#}
                                <div class="col-xl-3 mb-3">
                                    <label for="editEquipmentType" class="form-label">Equipment Type<span
                                            class="text-danger">*</span></label>
                                    <select class="form-control" id="editEquipmentType" name="equipmentType" required>
                                        <!-- Options will be populated dynamically -->
                                    </select>
                                </div>

                                <input type="hidden" id="editCategoryId" class="pagination-count">
                            </div>


                        </form>
                    </div>
                    <div class="modal-footer">
                        <button type="button" class="btn btn-secondary" id="closeFormBtn">Close</button>
                        <button type="button" class="btn btn-primary" id="saveChangesBtn">Save changes</button>
                    </div>
                </div>
            </div>
        </div>

        <!-- Add Equipment Details -->
        <div class="offcanvas offcanvas-end customeoff" tabindex="-1" id="offcanvasExample">
            <div class="offcanvas-header">
                <h5 class="modal-title" id="#gridSystemModal">Add Equipment</h5>
                <button type="button" class="btn-close" data-bs-dismiss="offcanvas" aria-label="Close">
                    <i class="fa-solid fa-xmark"></i>
                </button>
            </div>
            <div class="offcanvas-body">
                <form action="{% url 'add_equipment' %}" method="POST" enctype="multipart/form-data"
                      id="addEquipmentForm">
                    {% csrf_token %}
                    <div class="row">
                        <div>
                            <h3>General Information</h3>
                            <hr/>
                        </div>
                        <div class="col-xl-3 mb-3">
                            <label for="exampleFormControlInput2" class="form-label">Equipment Name<span
                                    class="text-danger">*</span></label>
                            <input type="text" class="form-control" id="exampleFormControlInput2" name="equipment_name"
                                   placeholder="Equipment Name" required>
                        </div>
                        <div class="col-xl-3 mb-3">
                            <label for="exampleFormControlInput3" class="form-label">Sub Category Name<span
                                    class="text-danger">*</span></label>
                            <input type="text" class="form-control" name="subcategory_name"
                                   id="exampleFormControlInput3" required>
                            <input type="hidden" name="subcategory_id" id="hiddenSubcategoryId">
                        </div>
                        <div class="col-xl-3 mb-3">
                            <label for="exampleFormControlInput4" class="form-label">Category Type<span
                                    class="text-danger">*</span></label>
                            <input type="text" class="form-control" id="exampleFormControlInput4" name="category_type"
                                   placeholder="" required>
                        </div>
                        <div class="col-xl-3 mb-3">
                            <label for="exampleFormControlInput5" class="form-label">Type<span
                                    class="text-danger">*</span></label>
                            <select class="form-control" id="exampleFormControlInput5" name="type" required>
                                <!-- Options will be populated dynamically -->
                            </select>
                        </div>
                        <div>
                            <h3>Physical Measurements</h3>
                            <hr/>
                        </div>
                        <div class="col-xl-3 mb-3">
                            <label class="form-label">Dimension(H)</label>
                            <input type="number" class="form-control dimension" id="dimension_h" name="dimension_h"
                                   placeholder="">
                        </div>
                        <div class="col-xl-3 mb-3">
                            <label class="form-label">Dimension(W)</label>
                            <input type="number" class="form-control dimension" id="dimension_w" name="dimension_w"
                                   placeholder="">
                        </div>
                        <div class="col-xl-3 mb-3">
                            <label class="form-label">Dimension(L)</label>
                            <input type="number" class="form-control dimension" id="dimension_l" name="dimension_l"
                                   placeholder="">
                        </div>
                        <div class="col-xl-3 mb-3">
                            <label class="form-label">Volume</label>
                            <input type="number" class="form-control" id="volume" name="volume" placeholder="" readonly>
                        </div>
                        <div class="col-xl-3 mb-3">
                            <label for="exampleFormControlInput88" class="form-label">Weight</label>
                            <input type="number" class="form-control" id="exampleFormControlInput88" name="weight"
                                   placeholder="">
                        </div>
                        <div class="col-xl-3 mb-3">
                            <label for="exampleFormControlInput88" class="form-label">HSN NO<span
                                    class="text-danger">*</span></label>
                            <input type="number" class="form-control" id="exampleFormControlInput88" name="hsn_no"
                                   required>
                        </div>
                        <div class="col-xl-3 mb-3">
                            <label for="exampleFormControlInput88" class="form-label">Country of Origin</label>
                            <input type="text" class="form-control" id="exampleFormControlInput88" name="country_origin"
                                   placeholder="">
                        </div>
                        <div class="col-xl-3 mb-3">
                            <label class="form-label">Status</label>
                            <select class="default-select form-control" name="status">
                                <option value="1">Active</option>
                                <option value="0">Inactive</option>
                            </select>
                        </div>
                        <div class="col-xl-6 mb-3">
                            <label class="form-label">Attachment</label>
                            <input type="file" name="attachment" id="attachment" accept=".jpg, .jpeg, .png">
                        </div>
                    </div>
                    <div>
                        <button class="btn btn-primary me-1" type="submit">Submit</button>
                        <button class="btn btn-danger light ms-1" id="cancelButton">Cancel</button>
                    </div>
                </form>
            </div>
        </div>

        <!-- Equipment Details Modal -->
        <div class="modal fade" id="equipmentDetailsModal" tabindex="-1" role="dialog"
             aria-labelledby="equipmentDetailsModalLabel" aria-hidden="true">
            <div class="modal-dialog modal-lg" role="document">
                <div class="modal-content">
                    <div class="modal-header">
                        <h5 class="modal-title" id="equipmentDetailsModalLabel">Equipment Details</h5>
                        <button type="button" class="btn-close" data-bs-dismiss="modal" aria-label="Close"></button>
                    </div>
                    <div class="modal-body">
                        <table class="table table-bordered" id="equipmentDetailsTable">
                            <thead>
                            <tr>
                                <th>Vendor Name</th>
                                <th>Serial Number</th>
                                <th>Barcode Number</th>
                                <th>Unit Price</th>
                                <th>Rental Price</th>
                                <th>Purchase Date</th>
                                <th>Reference Number</th>
                            </tr>
                            </thead>
                            <tbody>
                            <!-- Table rows will be injected here -->
                            </tbody>
                        </table>
                    </div>
                    <div class="modal-footer">
                        <button type="button" class="btn btn-secondary" data-bs-dismiss="modal">Close</button>
                    </div>
                </div>
            </div>
        </div>

    </div>
    <!-- End Add Employee Section -->

    <!-- Vendor Details Form section -->
    <div class="modal fade" id="editVendorModal" tabindex="-1" role="dialog" aria-labelledby="editVendorModalLabel"
         aria-hidden="true">
        <div class="modal-dialog modal-lg" role="document">
            <div class="modal-content">
                <div class="modal-header">
                    <h5 class="modal-title" id="editVendorModalLabel">Add Vendor Details</h5>
                </div>
                <div class="modal-body">
                    <form id="vendorForm" method="POST" enctype="multipart/form-data">
                        {% csrf_token %}
                        <div class="row">
                            <input type="hidden" id="equipmentIdInput" name="equipmentId">

                            <div class="col-xl-4 mb-3">
                                <label for="vendor_name">Vendor Name<span class="text-danger">*</span></label>
                                <input type="text" class="form-control" id="vendor_name" name="vendor_name" required>
                            </div>
                            <div class="col-xl-4 mb-3">
                                <label for="purchase_date" class="form-label">Purchase Date<span
                                        class="text-danger">*</span></label>
                                <input type="date" class="form-control" id="purchase_date" name="purchase_date"
                                       required>
                            </div>
                            <div class="col-xl-4 mb-3">
                                <label for="unit_price" class="form-label">Unit Price<span class="text-danger">*</span></label>
                                <input type="number" class="form-control" id="unit_price" name="unit_price" required>
                            </div>
                            <div class="col-xl-4 mb-3">
                                <label for="rental_price" class="form-label">Rental Price<span
                                        class="text-danger">*</span></label>
                                <input type="number" class="form-control" id="rental_price" name="rental_price"
                                       required>
                            </div>
                            <div class="col-xl-4 mb-3">
                                <label for="reference_no" class="form-label">Reference No<span
                                        class="text-danger">*</span></label>
                                <input type="number" class="form-control" id="reference_no" name="reference_no"
                                       required>
                            </div>
                            <div class="col-xl-4 mb-3">
                                <label for="attachment" class="form-label">Attachment</label>
                                <input type="file" name="attachment" id="attachment" accept=".pdf">
                                <div id="attachmentError" class="text-danger" style="display: none;"></div>
                            </div>
                            <div class="col-xl-4 mb-3">
                                <label for="editUnit" class="form-label">Unit</label>
                                <input type="text" class="form-control" id="editUnit" name="unitValue" required>
                            </div>
                            <div id="serialNumberInputsContainer">
                                <!-- Serial Number input boxes will be dynamically generated here -->
                            </div>
                            <div id="stockDetailsContainer">
                                <!-- Previous Values for the Serial Number and Barcode Number input boxes will be generated here -->
                            </div>

                        </div>
                        <div class="modal-footer">
                            <button type="button" class="btn btn-secondary" id="closeFormBtn">Close</button>
                            <button type="submit" class="btn btn-primary" id="saveChanges">Submit</button>
                        </div>
                    </form>
                </div>
            </div>
        </div>
    </div>

    {#</div>#}


    <!-- End Vendor Details Form Section -->

    <!--**********************************
       Support ticket button start
    ***********************************-->

    <!--**********************************
       Support ticket button end
    ***********************************-->

    <!--**********************************
        Main wrapper end
    ***********************************-->

    <!--**********************************
        Scripts
    ***********************************-->

    </body>
    <script type="application/json" id="equipment-list-data">{{ equipment_listing|safe }}</script>

{% endblock %}
